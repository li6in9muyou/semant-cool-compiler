#!/usr/bin/env bash

red() {
  xargs printf "\033[0;31m%s\033[0m\n"
}

green() {
  xargs printf "\033[0;32m%s\033[0m\n"
}

actual() {
  mylexer "$1" | myparser | ./semant 2>&1
}

expected() {
  lexer "$1" | parser | semant 2>&1
}

make lexer

for cl in "$@"
do 
    input_cl="$cl"
    diff -u --color --label actual <(./lexer $input_cl) --label expected <(../../bin/lexer $input_cl)
    if [[ "$?" -eq 0 ]]; then
      echo PASS | green
    else
      echo FAILED | red
    fi
    echo INPUT:" ${input_cl}"
done

